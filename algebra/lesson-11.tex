\documentclass[12pt]{article}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[margin=2cm]{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{xcolor}
\usepackage{color}
\usepackage{amssymb}

\include{commands}

\begin{document}

    \title{Задача 11}
    \author{Тигетов Давид Георгиевич}
    \date{}
    \maketitle

    \section*{Пункт а}
    Докажите, что подпространство $W = \left < a, b \right >$ является инвариантным для оператора, заданного матрицей $A$:
    \[
        a = \begin{pmatrix}
                -2 \\ 1 \\ 1
        \end{pmatrix},
        b = \begin{pmatrix}
                3 \\ 2 \\ -5
        \end{pmatrix},
        A = \begin{pmatrix}
                2  & 10  & 5  \\
                3  & -15 & 6  \\
                -1 & 9   & -7
        \end{pmatrix}
    \]

    \subsection*{Решение:}
    Применим оператор к векторам $a$ и $b$:
    \begin{gather*}
        A a
        =
        \begin{pmatrix}
            -4 + 10 + 5 \\
            -6 - 15 + 6 \\
            2 + 9 - 7
        \end{pmatrix}
        =
        \begin{pmatrix}
            11  \\
            -15 \\
            4
        \end{pmatrix} , \\
        %
        A b
        =
        \begin{pmatrix}
            6 + 20 - 25   \\
            9 - 30 - 30   \\
            - 3 + 18 + 35 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
            1    \\
            - 51 \\
            50
        \end{pmatrix}
        .
    \end{gather*}

    Проверим принадлежность полученных векторов оболочке $W = \left < a, b \right >$:
    \begin{gather*}
        \begin{pmatrix}
            -2 & 3  & 11  & 1   \\
            1  & 2  & -15 & -51 \\
            1  & -5 & 4   & 50  \\
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            -2 & 7  & -19 & -101 \\
            1  & 0  & 0   & 0    \\
            1  & -7 & 19  & 101  \\
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            -2 & 7  & 0 & 0 \\
            1  & 0  & 0 & 0 \\
            1  & -7 & 0 & 0 \\
        \end{pmatrix}
    \end{gather*}
    Таким образом, $Aa \in W$ и $Ab \in W$, поэтому для любого вектора $x \in W$:
    \[
        x = \lambda_1 a + \lambda_2 b
        \rightarrow
        A x = \lambda_1 Aa + \lambda_2 Ab \in W.
    \]

    \section*{Пункт б}
    Найдите спектр и характеристический многочлен оператора, заданного матрицей
    \[
        \begin{pmatrix}
            -5 & -9 & 2  & 7   \\
            -3 & -2 & 1  & 3   \\
            9  & 9  & -5 & -12 \\
            -9 & -9 & 3  & 10
        \end{pmatrix}
    \]

    \subsection*{Решение:}
    Преобразования подобия сохраняют спектр и характеристический многочлен оператора:
    \begin{multline*}
        \begin{pmatrix}
            1 & 0 & 0 & 0 \\
            0 & 1 & 0 & 0 \\
            0 & 0 & 1 & 1 \\
            0 & 0 & 0 & 1
        \end{pmatrix}
        \begin{pmatrix}
            -5 & -9 & 2  & 7   \\
            -3 & -2 & 1  & 3   \\
            9  & 9  & -5 & -12 \\
            -9 & -9 & 3  & 10
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 & 0 & 0  \\
            0 & 1 & 0 & 0  \\
            0 & 0 & 1 & -1 \\
            0 & 0 & 0 & 1
        \end{pmatrix} = \\
        %
        =
        \begin{pmatrix}
            -5 & -9 & 2  & 7  \\
            -3 & -2 & 1  & 3  \\
            0  & 0  & -2 & -2 \\
            -9 & -9 & 3  & 10
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 & 0 & 0  \\
            0 & 1 & 0 & 0  \\
            0 & 0 & 1 & -1 \\
            0 & 0 & 0 & 1
        \end{pmatrix}
        =
        \begin{pmatrix}
            -5 & -9 & 2  & 5 \\
            -3 & -2 & 1  & 2 \\
            0  & 0  & -2 & 0 \\
            -9 & -9 & 3  & 7
        \end{pmatrix}.
    \end{multline*}

    Характеристический многочлен:
    \begin{multline*}
        P(\lambda)
        = \begin{vmatrix}
              -5 - \lambda & -9           & 2            & 5           \\
              -3           & -2 - \lambda & 1            & 2           \\
              0            & 0            & -2 - \lambda & 0           \\
              -9           & -9           & 3            & 7 - \lambda
        \end{vmatrix}
        = ( -2 - \lambda)
        \begin{vmatrix}
            -5 - \lambda & -9           & 5           \\
            -3           & -2 - \lambda & 2           \\
            -9           & -9           & 7 - \lambda
        \end{vmatrix} = \\
        %
        = (-2 - \lambda) ( (-5 - \lambda)(-2 - \lambda)(7 - \lambda) + 135 + 162 + 45(-2 - \lambda) + 18 (-5 - \lambda) - 27(7 - \lambda) ) = \\
        %
        = (-2 - \lambda) ( (-5 - \lambda)(-2 - \lambda)(7 - \lambda) + 297 - 90 - 45 \lambda - 90 - 18 \lambda - 189 + 27 \lambda ) = \\
        %
        = (-2 - \lambda) ( (-5 - \lambda)(-2 - \lambda)(7 - \lambda) - 72 - 36 \lambda ) = \\
        %
        = (-2 - \lambda) ( (-5 - \lambda)(-2 - \lambda)(7 - \lambda) + 36 (- 2 - \lambda ) ) = \\
        %
        = (-2 - \lambda)^2 ( (-5 - \lambda)(7 - \lambda) + 36 )
        = (\lambda + 2)^2 (-35 - 7 \lambda + 5 \lambda + \lambda^2 + 36) = \\
        %
        = (\lambda + 2)^2 (\lambda^2 - 2 \lambda + 1)
        = (\lambda + 2)^2 (\lambda - 1)^2 .
    \end{multline*}

    \subsection*{Ответ:}
    Характеристический многочлен $(\lambda + 2)^2 (\lambda - 1)^2$, спектр $\set{-2, 1}$.

    \section*{Пункт в}
    Докажите, что подпространство $W = \left < a, b, c \right >$ является инвариантным для оператора, заданного матрицей $A$:
    \[
        a  = \begin{pmatrix}
                 -3 \\ 1 \\ 2 \\ 3 \\ -3
        \end{pmatrix} ,
        b = \begin{pmatrix}
                0 \\ 2 \\ -3 \\ 0 \\ 1
        \end{pmatrix},
        c = \begin{pmatrix}
                2 \\ -1 \\ 0 \\ -2 \\ 1
        \end{pmatrix},
        A =
        \begin{pmatrix}
            1  & 2  & -1 & -2 & 0  \\
            1  & 3  & 2  & -2 & 2  \\
            1  & 0  & -1 & 4  & 3  \\
            -1 & -2 & 1  & 2  & 0  \\
            1  & 0  & 2  & 1  & -2
        \end{pmatrix}
        .
    \]
    и постройте базис, в котором матрица оператора будет иметь блочно-диагональный вид с блоками 3x3 и 2x2.

    \subsection*{Решение:}
    Действие оператора на векторы $a$, $b$, $c$:
    \begin{gather*}
        A a
        =
        \begin{pmatrix}
            -3 + 2 - 2 - 6 + 0  \\
            -3 + 3 + 4 - 6 - 6  \\
            -3 + 0 - 2 + 12 - 9 \\
            3 - 2 + 2 + 6 + 0   \\
            -3 + 0 + 4 + 3 + 6
        \end{pmatrix}
        =
        \begin{pmatrix}
            -9 \\
            -8 \\
            -2 \\
            9  \\
            10
        \end{pmatrix} , \\
        %
        A b
        =
        \begin{pmatrix}
            0 + 4 + 3 + 0 + 0 \\
            0 + 6 - 6 + 0 + 2 \\
            0 + 0 + 3 + 0 + 3 \\
            0 - 4 - 3 + 0 + 0 \\
            0 + 0 - 6 + 0 - 2 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
            7  \\
            2  \\
            6  \\
            -7 \\
            - 8
        \end{pmatrix} , \\
        %
        A c
        =
        \begin{pmatrix}
            2 - 2 + 0 + 4 + 0  \\
            2 - 3 + 0 + 4 + 2  \\
            2 + 0 + 0 - 8 + 3  \\
            -2 + 2 + 0 - 4 + 0 \\
            2 + 0 + 0 - 2 - 2
        \end{pmatrix}
        =
        \begin{pmatrix}
            4  \\
            5  \\
            -3 \\
            -4 \\
            -2
        \end{pmatrix} .
    \end{gather*}

    Проверим принадлежность полученных векторов подпространству $W$ и найдем их разложения по векторам $a$, $b$, $c$:
    \begin{gather*}
        \left .
        \begin{pmatrix}
            -3 & 0  & 2  \\
            1  & 2  & -1 \\
            2  & -3 & 0  \\
            3  & 0  & -2 \\
            -3 & 1  & 1
        \end{pmatrix}
        \right |
        \begin{pmatrix}
            -9 & 7  & 4  \\
            -8 & 2  & 5  \\
            -2 & 6  & -3 \\
            9  & -7 & -4 \\
            10 & -8 & -2
        \end{pmatrix}
        \rightarrow
        \left .
        \begin{pmatrix}
            3  & -2 & 0 \\
            -2 & 3  & 0 \\
            2  & -3 & 0 \\
            -3 & 2  & 0 \\
            -3 & 1  & 1
        \end{pmatrix}
        \right |
        \begin{pmatrix}
            -29 & 23  & 8  \\
            2   & -6  & 3  \\
            -2  & 6   & -3 \\
            29  & -23 & -8 \\
            10  & -8  & -2
        \end{pmatrix}
        \rightarrow \\
        %
        \rightarrow
        \left .
        \begin{pmatrix}
            3  & -2 & 0 \\
            -2 & 3  & 0 \\
            0  & 0  & 0 \\
            0  & 0  & 0 \\
            -3 & 1  & 1
        \end{pmatrix}
        \right |
        \begin{pmatrix}
            -29 & 23 & 8  \\
            2   & -6 & 3  \\
            0   & 0  & 0  \\
            0   & 0  & 0  \\
            10  & -8 & -2
        \end{pmatrix}
        \rightarrow
        \left .
        \begin{pmatrix}
            1  & 1 & 0 \\
            -2 & 3 & 0 \\
            0  & 0 & 0 \\
            0  & 0 & 0 \\
            -3 & 1 & 1
        \end{pmatrix}
        \right |
        \begin{pmatrix}
            -27 & 17 & 11 \\
            2   & -6 & 3  \\
            0   & 0  & 0  \\
            0   & 0  & 0  \\
            10  & -8 & -2
        \end{pmatrix}
        \rightarrow \\
        %
        \rightarrow
        \left .
        \begin{pmatrix}
            1  & 1 & 0 \\
            0  & 5 & 0 \\
            0  & 0 & 0 \\
            0  & 0 & 0 \\
            -3 & 1 & 1
        \end{pmatrix}
        \right |
        \begin{pmatrix}
            -27 & 17 & 11 \\
            -52 & 28 & 25 \\
            0   & 0  & 0  \\
            0   & 0  & 0  \\
            10  & -8 & -2
        \end{pmatrix}
    \end{gather*}
    Таким образом,
    \begin{gather*}
        Aa = - \frac{83}{5} a - \frac{52}{5} b - \frac{147}{5} c , \\
        Ab = \frac{57}{5} a + \frac{28}{5} b + \frac{103}{5} c , \\
        Ac = 6 a + 5 b + 11 c .
    \end{gather*}

    Матрица оператора в базисе $a$, $b$, $c$, $e_4$, $e_5$, где $e_i$ --- векторы стандартного базиса, с матрицей перехода:
    \[
        C
        =
        \begin{pmatrix}
            -3 & 0  & 2  & 0 & 0 \\
            1  & 2  & -1 & 0 & 0 \\
            2  & -3 & 0  & 0 & 0 \\
            3  & 0  & -2 & 1 & 0 \\
            -3 & 1  & 1  & 0 & 1
        \end{pmatrix}
    \]
    будет иметь вид:
    \[
        A_C
        = C^{-1} A C
        =
        \begin{pmatrix}
            - \frac{83}{5}  & \frac{57}{5}  & 6  & - \frac{2}{5} & \frac{24}{5} \\
            - \frac{52}{5}  & \frac{28}{5}  & 5  & - \frac{8}{5} & \frac{11}{5} \\
            - \frac{147}{5} & \frac{103}{5} & 11 & - \frac{8}{5} & \frac{36}{5} \\
            0               & 0             & 0  & 0             & 0            \\
            0               & 0             & 0  & 3             & 3
        \end{pmatrix}
    \]

    Рассмотрим характеристический многочлен:
    \begin{multline*}
        P(\lambda)
        = \determinant{A_C - \lambda E}
        = \begin{vmatrix}
              - \frac{83}{5} - \lambda & \frac{57}{5}           & 6            & - \frac{2}{5} & \frac{24}{5} \\
              - \frac{52}{5}           & \frac{28}{5} - \lambda & 5            & - \frac{8}{5} & \frac{11}{5} \\
              - \frac{147}{5}          & \frac{103}{5}          & 11 - \lambda & - \frac{8}{5} & \frac{36}{5} \\
              0                        & 0                      & 0            & - \lambda     & 0            \\
              0                        & 0                      & 0            & 3             & 3 - \lambda
        \end{vmatrix} = \\
        %
        =
        \begin{vmatrix}
            - \frac{83}{5} - \lambda & \frac{57}{5}           & 6            \\
            - \frac{52}{5}           & \frac{28}{5} - \lambda & 5            \\
            - \frac{147}{5}          & \frac{103}{5}          & 11 - \lambda
        \end{vmatrix}
        \cdot
        \begin{vmatrix}
            - \lambda & 0           \\
            3         & 3 - \lambda
        \end{vmatrix}
    \end{multline*}
    откуда следует, что у оператора есть нетривиальное ядро и собственное значение 3.

    Найдем вектор ядра $v_1$:
    \begin{gather*}
        A v_1 = 0, \\
        \begin{pmatrix}
            1  & 2  & -1 & -2 & 0  \\
            1  & 3  & 2  & -2 & 2  \\
            1  & 0  & -1 & 4  & 3  \\
            -1 & -2 & 1  & 2  & 0  \\
            1  & 0  & 2  & 1  & -2
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            1 & 2  & -1 & -2 & 0  \\
            0 & 1  & 3  & 0  & 2  \\
            0 & -2 & 0  & 6  & 3  \\
            0 & 0  & 0  & 0  & 0  \\
            0 & -2 & 3  & 3  & -2
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            1 & 2 & -1 & -2 & 0 \\
            0 & 1 & 3  & 0  & 2 \\
            0 & 0 & 6  & 6  & 7 \\
            0 & 0 & 0  & 0  & 0 \\
            0 & 0 & 9  & 3  & 2
        \end{pmatrix}
        \rightarrow \\
        %
        \rightarrow
        \begin{pmatrix}
            1 & 2 & -1 & -2 & 0  \\
            0 & 1 & 3  & 0  & 2  \\
            0 & 0 & 6  & 6  & 7  \\
            0 & 0 & 0  & 0  & 0  \\
            0 & 0 & 3  & -3 & -5
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            1 & 2 & -1 & -2 & 0  \\
            0 & 1 & 3  & 0  & 2  \\
            0 & 0 & 12 & 0  & -3 \\
            0 & 0 & 0  & 0  & 0  \\
            0 & 0 & 3  & -3 & -5
        \end{pmatrix}
    \end{gather*}
    откуда
    \[
        v_1 = \begin{pmatrix}
                  35 \\ -33 \\ 3 \\ -17 \\ 12
        \end{pmatrix} .
    \]

    Найдем собственный вектор $v_2$, соответствующий собственному значению 3.
    \begin{gather*}
        \left ( A - 3 E \right ) v_2 = 0, \\
        \begin{pmatrix}
            -2 & 2  & -1 & -2 & 0  \\
            1  & 0  & 2  & -2 & 2  \\
            1  & 0  & -4 & 4  & 3  \\
            -1 & -2 & 1  & -1 & 0  \\
            1  & 0  & 2  & 1  & -5
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            0 & 2  & 3  & -6 & 4  \\
            1 & 0  & 2  & -2 & 2  \\
            0 & 0  & -6 & 6  & 1  \\
            0 & -2 & 3  & -3 & 2  \\
            0 & 0  & 0  & 3  & -7
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            0 & 2 & 3  & -6 & 4  \\
            1 & 0 & 2  & -2 & 2  \\
            0 & 0 & -6 & 6  & 1  \\
            0 & 0 & 6  & -9 & 6  \\
            0 & 0 & 0  & 3  & -7
        \end{pmatrix}
        \rightarrow \\
        %
        \rightarrow
        \begin{pmatrix}
            0 & 2 & 3  & -6 & 4  \\
            1 & 0 & 2  & -2 & 2  \\
            0 & 0 & -6 & 6  & 1  \\
            0 & 0 & 0  & -3 & 7  \\
            0 & 0 & 0  & 3  & -7
        \end{pmatrix}
    \end{gather*}
    откуда
    \[
        v_2 = \begin{pmatrix}
                  - 28 \\ 15 \\ 30 \\ 28 \\ 12
        \end{pmatrix}
        .
    \]

    Векторы $a$, $b$, $c$, $v_1$, $v_2$ являются линейно независимыми, действительно:
    \begin{gather*}
        \begin{pmatrix}
            -3 & 0  & 2  & 35  & -28 \\
            1  & 2  & -1 & -33 & 15  \\
            2  & -3 & 0  & 2   & 30  \\
            3  & 0  & -2 & -17 & 28  \\
            -3 & 1  & 1  & 12  & 12
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            -3 & 0  & 2  & 35  & -28 \\
            1  & 2  & -1 & -33 & 15  \\
            2  & -3 & 0  & 2   & 30  \\
            0  & 0  & 0  & 18  & 0   \\
            0  & 1  & -1 & -23 & 40
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            0 & -1 & 1  & 5   & 17 \\
            1 & 2  & -1 & -33 & 15 \\
            2 & -3 & 0  & 2   & 30 \\
            0 & 0  & 0  & 18  & 0  \\
            0 & 1  & -1 & -23 & 40
        \end{pmatrix}
        \rightarrow \\
        %
        \rightarrow
        \begin{pmatrix}
            0 & -1 & 1  & 5   & 17 \\
            1 & 2  & -1 & -33 & 15 \\
            0 & -7 & 2  & 69  & 0  \\
            0 & 0  & 0  & 18  & 0  \\
            0 & 1  & -1 & -23 & 40
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            0 & -1 & 1  & 5   & 17   \\
            1 & 2  & -1 & -33 & 15   \\
            0 & 0  & -5 & 34  & -119 \\
            0 & 0  & 0  & 18  & 0    \\
            0 & 1  & -1 & -23 & 40
        \end{pmatrix}
        \rightarrow
        \begin{pmatrix}
            0 & -1 & 1  & 5   & 17   \\
            1 & 2  & -1 & -33 & 15   \\
            0 & 0  & -5 & 34  & -119 \\
            0 & 0  & 0  & 18  & 0    \\
            0 & 0  & 0  & -18 & 57
        \end{pmatrix}
    \end{gather*}
    и количество векторов 5, поэтому набор векторов $a$, $b$, $c$, $v_1$, $v_2$ является базисом.

    В базисе $a$, $b$, $c$, $v_1$, $v_2$ с матрицей перехода:
    \[
        D
        =
        \begin{pmatrix}
            -3 & 0  & 2  & 35  & -28 \\
            1  & 2  & -1 & -33 & 15  \\
            2  & -3 & 0  & 2   & 30  \\
            3  & 0  & -2 & -17 & 28  \\
            -3 & 1  & 1  & 12  & 12
        \end{pmatrix}
    \]
    матрица оператора будет иметь блочно-диагональный вид:
    \[
        A_D
        = D^{-1} A D
        =
        \begin{pmatrix}
            - \frac{83}{5}  & \frac{57}{5}  & 6  & 0 & 0 \\
            - \frac{52}{5}  & \frac{28}{5}  & 5  & 0 & 0 \\
            - \frac{147}{5} & \frac{103}{5} & 11 & 0 & 0 \\
            0               & 0             & 0  & 0 & 0 \\
            0               & 0             & 0  & 0 & 3
        \end{pmatrix}
        .
    \]

    \subsection*{Ответ:}
    Базис $a$, $b$, $c$, $v_1$, $v_2$, где
    \[
        v_1 = \begin{pmatrix}
                  35 \\ -33 \\ 3 \\ -17 \\ 12
        \end{pmatrix} ,
        v_2 = \begin{pmatrix}
                  - 28 \\ 15 \\ 30 \\ 28 \\ 12
        \end{pmatrix} .
    \]

    \section*{Пункт г}
    Найдите все инвариантные подпространства оператора, заданного матрицей:
    \[
        A
        = \begin{pmatrix}
              1   & 0   & 0 \\
              -20 & -15 & 0 \\
              8   & -7  & 4
        \end{pmatrix}
    \]

    \subsection*{Решение:}
    Найдем собственные числа --- корни характеристического многочлена:
    \[
        \determinant{A - \lambda E}
        = \begin{vmatrix}
              1 - \lambda & 0             & 0           \\
              -20         & -15 - \lambda & 0           \\
              8           & -7            & 4 - \lambda
        \end{vmatrix}
        = 0 .
    \]
    Собстенные числа: $\lambda_1 = 1$, $\lambda_2 = -15$, $\lambda_3 = 4$, каждому соответствует собственный вектор $a_i$, являющийся решением
    соответствующей ОСЛУ:
    \begin{gather*}
        \left ( A - \lambda_1 E \right ) a_1
        = \begin{pmatrix}
              0   & 0   & 0 \\
              -20 & -16 & 0 \\
              8   & -7  & 3
        \end{pmatrix}
        a_1 = 0
        \rightarrow
        a_1
        = \begin{pmatrix}
              1 \\ - \frac{5}{4} \\ - \frac{8 + \frac{35}{4}}{3}
        \end{pmatrix}
        = \begin{pmatrix}
              1 \\ - \frac{5}{4} \\ - \frac{67}{12}
        \end{pmatrix} , \\
        %
        \left ( A - \lambda_2 E \right ) a_2
        = \begin{pmatrix}
              16  & 0  & 0  \\
              -20 & 0  & 0  \\
              8   & -7 & 19
        \end{pmatrix}
        a_2 = 0
        \rightarrow
        a_2
        = \begin{pmatrix}
              0 \\ 1 \\ \frac{7}{19}
        \end{pmatrix} , \\
        %
        \left ( A - \lambda_3 E \right ) a_3
        = \begin{pmatrix}
              -3  & 0   & 0 \\
              -20 & -19 & 0 \\
              8   & -7  & 0
        \end{pmatrix}
        a_3 = 0
        \rightarrow
        a_3
        = \begin{pmatrix}
              0 \\ 0 \\ 1
        \end{pmatrix}
        %
    \end{gather*}

    \subsection*{Ответ:}
    Всего три инвариантных подпространства $W_i = \left < a_i \right >$, где
    \[
        a_1 = \begin{pmatrix}
                  1 \\ - \frac{5}{4} \\ - \frac{67}{12}
        \end{pmatrix} ,
        a_2 = \begin{pmatrix}
                  0 \\ 1 \\ \frac{7}{19}
        \end{pmatrix} ,
        a_3 = \begin{pmatrix}
                  0 \\ 0 \\ 1
        \end{pmatrix} .
    \]
\end{document}