\documentclass[12pt]{article}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[margin=2cm]{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{xcolor}
\usepackage{color}
\usepackage{amssymb}

\include{commands}

\begin{document}

    \title{Задача 13}
    \author{Тигетов Давид Георгиевич}
    \date{}
    \maketitle

    \section*{Пункт а}
    Найдите жорданову нормальную форму и жорданов базис для операторов, заданных матрицами:
    \[
        A =
        \begin{pmatrix}
            -2 & -3 & -4 \\
            -1 & 0  & 0  \\
            1  & 1  & 1
        \end{pmatrix},
        B =
        \begin{pmatrix}
            -5 & -9 & 2  & 7   \\
            -3 & -2 & 1  & 3   \\
            9  & 9  & -5 & -12 \\
            -9 & -9 & 3  & 10
        \end{pmatrix}
    \]

    \subsection*{Решение:}
    У матрицы $A$ два собственных значения $\lambda_1 = -1$ и $\lambda_2 = 1$.

    Для собственного значения $\lambda_1$ есть только один собственный вектор, поэтому строим базис в корневом подпространстве $\kernel{\left ( A - \lambda_1 E \right)^2}$, в котором
    выберем вектор
    \begin{gather*}
        v_2 \in \kernel{\left ( A - \lambda_1 E \right)^2}, \\
        v_2 \notin \kernel{\left ( A - \lambda_1 E \right)}.
    \end{gather*}
    Таким вектором является:
    \[
        v_2 = \begin{pmatrix}
                  1 \\ 0 \\ 0
        \end{pmatrix}.
    \]
    Под действием $\left ( A - \lambda_1 E \right )$ вектор $v_1$ переходит во второй базисный вектор $v_2$:
    \[
        v_1
        = \left ( A - \lambda_1 E \right ) v_2
        = \begin{pmatrix}
              -1 \\ -1 \\ 1
        \end{pmatrix}.
    \]

    Для собственного значения $\lambda_2$ есть собственный вектор:
    \[
        v_3 = \begin{pmatrix}
                  -1 \\ 1 \\ 0
        \end{pmatrix} .
    \]

    Матрица перехода к базису $v_1$, $v_2$, $v_3$:
    \[
        C_A =
        \begin{pmatrix}
            -1 & 1 & -1 \\
            -1 & 0 & 1  \\
            1  & 0 & 0
        \end{pmatrix}.
    \]

    Матрица оператора в базисе $v_1$, $v_2$, $v_3$:
    \[
        J_A
        = C_A^{-1} A C_A
        = \begin{pmatrix}
              -1 & 1  & 0 \\
              0  & -1 & 0 \\
              0  & 0  & 1
        \end{pmatrix}.
    \]

    У матрицы $B$ два собственных значения $\lambda_1 = -2$ и $\lambda_2 = 1$.

    Для $\lambda_1$ всего один собственный вектор --- требуется рассмотреть корневое подпространство. Кратность корня равна 2, поэтому достаточно рассмотреть
    $\kernel{\left ( B - \lambda_1 E \right )^2}$. Возьмем вектор
    \begin{gather*}
        v_2 \in \kernel{\left ( B - \lambda_1 E \right)^2}, \\
        v_2 \notin \kernel{\left ( B - \lambda_1 E \right)}, \\
        v_2 = \begin{pmatrix}
                  0 \\ 0 \\ 1 \\ 0
        \end{pmatrix}.
    \end{gather*}
    В качестве второго базисного вектора из $\kernel{\left ( B - \lambda_1 E \right )^2}$ возьмем
    \[
        v_1
        = \left ( B - \lambda_1 E \right ) v_2
        = \begin{pmatrix}
              2 \\ 1 \\ -3 \\ 3
        \end{pmatrix} .
    \]

    Для $\lambda_2$ также один собственный вектор, рассматриваем корневое подпространство $\kernel{\left ( B - \lambda_1 E \right )^2}$:
    \begin{gather*}
        v_4 \in \kernel{\left ( B - \lambda_2 E \right)^2}, \\
        v_4 \notin \kernel{\left ( B - \lambda_2 E \right)}, \\
        v_4 = \begin{pmatrix}
                  -2 \\ 1 \\ 0 \\ 0
        \end{pmatrix}, \\
        %
        v_3
        = \left ( B - \lambda_2 E \right) v_4
        = \begin{pmatrix}
              3 \\ 3 \\ -9 \\ 9
        \end{pmatrix}.
    \end{gather*}

    Матрица перехода к базису $v_1$, $v_2$, $v_3$, $v_4$:
    \[
        C_B
        = \begin{pmatrix}
              2  & 0 & 3  & -2 \\
              1  & 0 & 3  & 1  \\
              -3 & 1 & -9 & 0  \\
              3  & 0 & 9  & 0
        \end{pmatrix}.
    \]
    Матрица оператора в базисе $v_1$, $v_2$, $v_3$, $v_4$:
    \[
        J_B
        = C_B^{-1} B C_B
        = \begin{pmatrix}
              -2 & 1  & 0 & 0 \\
              0  & -2 & 0 & 0 \\
              0  & 0  & 1 & 1 \\
              0  & 0  & 0 & 1
        \end{pmatrix}.
    \]

    \subsection*{Ответ:}
    Для матрицы $A$ жорданова форма:
    \[
        \begin{pmatrix}
            -1 & 1  & 0 \\
            0  & -1 & 0 \\
            0  & 0  & 1
        \end{pmatrix}.
    \]
    в жордановом базисе:
    \begin{gather*}
        v_1 = \begin{pmatrix}
                  -1 \\ -1 \\ 1
        \end{pmatrix},
        v_2 = \begin{pmatrix}
                  1 \\ 0 \\ 0
        \end{pmatrix},
        v_3 = \begin{pmatrix}
                  -1 \\ 1 \\ 0
        \end{pmatrix} .
    \end{gather*}

    Для матрицы $B$ жорданова форма:
    \[
        \begin{pmatrix}
            -2 & 1  & 0 & 0 \\
            0  & -2 & 0 & 0 \\
            0  & 0  & 1 & 1 \\
            0  & 0  & 0 & 1
        \end{pmatrix}.
    \]
    в жордановом базисе:
    \begin{gather*}
        v_1 = \begin{pmatrix}
                  2 \\ 1 \\ -3 \\ 3
        \end{pmatrix} ,
        v_2 = \begin{pmatrix}
                  0 \\ 0 \\ 1 \\ 0
        \end{pmatrix},
        v_3 = \begin{pmatrix}
                  3 \\ 3 \\ -9 \\ 9
        \end{pmatrix},
        v_4 = \begin{pmatrix}
                  -2 \\ 1 \\ 0 \\ 0
        \end{pmatrix}.
    \end{gather*}

    \section*{Пункт б}
    Найдите $A^{1000000}$ и $B^{1000000}$, где
    \[
        A =
        \begin{pmatrix}
            -2 & -3 & -4 \\
            -1 & 0  & 0  \\
            1  & 1  & 1
        \end{pmatrix},
        B =
        \begin{pmatrix}
            -5 & -9 & 2  & 7   \\
            -3 & -2 & 1  & 3   \\
            9  & 9  & -5 & -12 \\
            -9 & -9 & 3  & 10
        \end{pmatrix}.
    \]

    \subsection*{Решение:}
    Используя нормальную жорданову форму из пункта а:
    \[
        A^N
        = C_A^{-1} J_A^N C_A
    \]
    где
    \[
        J_A^N
        = \begin{pmatrix}
              \begin{pmatrix}
                  -1 & 1  \\
                  0  & -1
              \end{pmatrix}^N & 0 \\
              0 & 1^N
        \end{pmatrix}
        = \begin{pmatrix}
        (-1)
              ^N & (-1)^N N & 0   \\
              0  & (-1)^N   & 0   \\
              0  & 0        & 1^N
        \end{pmatrix} .
    \]
    Таким образом,
    \begin{multline*}
        A^{1000000}
        = C_A^{-1}
        \begin{pmatrix}
            1 & -1000000 & 0 \\
            0 & 1        & 0 \\
            0 & 0        & 1
        \end{pmatrix}
        C_A
        = C_A^{-1}
        \left (
        E
        + \begin{pmatrix}
              0 & 1000000 & 0 \\
              0 & 0       & 0 \\
              0 & 0       & 0
        \end{pmatrix}
        \right )
        C_A
        = \\
        %
        = C_A^{-1} C_A
        + C_A^{-1} \begin{pmatrix}
                       0 & 1000000 & 0 \\
                       0 & 0       & 0 \\
                       0 & 0       & 0
        \end{pmatrix}
        C_A
        = \\
        = E
        + \begin{pmatrix}
              0        & 0 & 0       \\
              -1000000 & 0 & 1000000 \\
              0        & 0 & 0
        \end{pmatrix}
        = \begin{pmatrix}
              1        & 0 & 0       \\
              -1000000 & 1 & 1000000 \\
              0        & 0 & 1
        \end{pmatrix}.
    \end{multline*}

    Аналогично
    \[
        B^N = C_B^{-1} J_B^N C_B ,
    \]
    где
    \[
        J_B^N
        = \begin{pmatrix}
              \begin{pmatrix}
                  -2 & 1  \\
                  0  & -2
              \end{pmatrix}^N & 0 \\
              0 & \begin{pmatrix}
                      1 & 1 \\
                      0 & 1
              \end{pmatrix}^N
        \end{pmatrix}
        =
        \begin{pmatrix}
        (-2)
            ^N & N \cdot (-2)^{N-1} & 0   & 0   \\
            0  & (-2)^N             & 0   & 0   \\
            0  & 0                  & 1^N & N   \\
            0  & 0                  & 0   & 1^N \\
        \end{pmatrix},
    \]
    тогда
    \begin{multline*}
        B^{1000000}
        = C_B^{-1}
        \begin{pmatrix}
        (-2)
            ^{1000000} & 1000000 \cdot (-2)^{99999} & 0 & 0       \\
            0          & (-2)^{1000000}             & 0 & 0       \\
            0          & 0                          & 1 & 1000000 \\
            0          & 0                          & 0 & 1       \\
        \end{pmatrix}
        C_B
        = \\
        = \begin{pmatrix}
              4 \cdot (-2) - 3 \cdot 1 + 1                                & 0 & 9 \cdot (-2) - 9 \cdot 1 + 3  & 1             \\
              3                                                           & 1 & 9                             & 0             \\
              -\frac{4}{3} \cdot (-2) + \frac{4}{3} \cdot 1 - \frac{1}{3} & 0 & -3 \cdot (-2) + 4 \cdot 1 - 1 & - \frac{1}{3} \\
              -2 - 1                                                      & 0 & 3 \cdot (-2) - 3 \cdot 1      & -2
        \end{pmatrix}
        =
        \begin{pmatrix}
            -10          & 0 & -24 & 1             \\
            3            & 1 & 9   & 0             \\
            \frac{11}{3} & 0 & 9   & - \frac{1}{3} \\
            -3           & 0 & -9  & -2
        \end{pmatrix}
    \end{multline*}

    \subsection*{Ответ:}
    $
    A^{1000000}
    = \begin{pmatrix}
          1        & 0 & 0       \\
          -1000000 & 1 & 1000000 \\
          0        & 0 & 1
    \end{pmatrix}
    $,
    $
    B^{1000000}
    = \begin{pmatrix}
          -10          & 0 & -24 & 1             \\
          3            & 1 & 9   & 0             \\
          \frac{11}{3} & 0 & 9   & - \frac{1}{3} \\
          -3           & 0 & -9  & -2
    \end{pmatrix}
    $.
\end{document}